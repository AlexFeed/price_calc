<!DOCTYPE html>
{% load static %}
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Управление письмами</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'styles/interface_database.css' %}">
    <script src="{% static 'js_scripts/interface_database.js' %}"></script>
</head>
<body class="not-logged-in">
    <header class="auth-only">
        <div class="logo">
            <a class="logo-icon" href="/calculator/">АТК</a>
            <h1>Управление письмами</h1>
        </div>
        <div class="user-info">
            <div class="user-avatar" id="userAvatar">U</div>
            <span id="userEmailDisplay"></span>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                Выйти
            </button>
        </div>
    </header>

    <div class="auth-container">
        <div class="auth-form">
            <h2 class="auth-title">Вход в систему</h2>

            <div class="auth-tabs">
                <div class="auth-tab active" id="loginTab">Вход</div>
                <div class="auth-tab" id="registerTab">Регистрация</div>
            </div>

            <div id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Электронная почта</label>
                    <input type="email" id="loginEmail" placeholder="example@mail.com">
                </div>
                <div class="form-group">
                    <label for="loginPassword">Пароль</label>
                    <input type="password" id="loginPassword" placeholder="Введите пароль">
                </div>
                <button class="auth-btn" id="loginBtn">Войти</button>
                <div class="auth-error" id="loginError">Неверный email или пароль</div>
            </div>

            <div id="registerForm" class="hidden">
                <div class="form-group">
                    <label for="registerEmail">Электронная почта</label>
                    <input type="email" id="registerEmail" placeholder="example@mail.com">
                </div>
                <div class="form-group">
                    <label for="registerPassword">Пароль</label>
                    <input type="password" id="registerPassword" placeholder="Придумайте пароль">
                </div>
                <div class="form-group">
                    <label for="registerConfirmPassword">Подтвердите пароль</label>
                    <input type="password" id="registerConfirmPassword" placeholder="Повторите пароль">
                </div>
                <button class="auth-btn" id="registerBtn">Зарегистрироваться</button>
                <div class="auth-error" id="registerError">Ошибка регистрации</div>
            </div>
        </div>
    </div>

    <div class="container auth-only">
        <div class="dashboard">
            <div class="dashboard-header">
                <h2 class="dashboard-title">Обработка писем</h2>
                <div>
                    <a class="add-btn" href="/calculator/">
                        <i class="fas fa-calculator"></i>
                        Открыть калькулятор
                    </a>
                </div>
            </div>

            <div class="controls">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Поиск по клиенту или маршруту...">
                </div>
                <select class="filter-select" id="statusFilter">
                    <option value="all">Все статусы</option>
                    <option value="correct">Корректно</option>
                    <option value="incorrect">Некорректно</option>
                    <option value="pending">В обработке</option>
                </select>
                <button class="add-btn" id="addRecordBtn">
                    <i class="fas fa-plus"></i>
                    Добавить письмо
                </button>
            </div>

            <div class="data-container">
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Компания</th>
                                <th>Email</th>
                                <th>Маршрут (откуда-куда)</th>
                                <th>Контейнер</th>
                                <th>Транспорт</th>
                                <th>Ставка</th>
                                <th>Дата расчёта</th>
                                <th>Корректность обработки</th>
                                <th>Действия</th>
                            </tr>
                        </thead>
                        <tbody id="recordsTableBody">
                            <!-- Записи будут добавляться динамически -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination">
                    <div class="page-info">Показано 1-10 из 127 писем</div>
                    <div class="page-controls">
                        <button class="page-btn"><i class="fas fa-chevron-left"></i></button>
                        <button class="page-btn active">1</button>
                        <button class="page-btn">2</button>
                        <button class="page-btn">3</button>
                        <button class="page-btn">4</button>
                        <button class="page-btn">5</button>
                        <button class="page-btn"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для добавления/редактирования записи -->
    <div class="modal" id="recordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">Добавить письмо</h3>
                <button class="close-btn" id="closeModalBtn">&times;</button>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="clientName">Название компании</label>
                    <input type="text" id="clientName" placeholder="Введите название...">
                </div>
                <div class="form-group">
                    <label for="clientEmail">Email компании</label>
                    <input type="email" id="clientEmail" placeholder="Формат: mail@example.com">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="routeFrom">Откуда</label>
                    <input type="text" id="routeFrom" placeholder="Город отправления">
                </div>
                <div class="form-group">
                    <label for="routeTo">Куда</label>
                    <input type="text" id="routeTo" placeholder="Город назначения">
                </div>
            </div>

            <!-- Тип контейнера и транспорта -->
            <div class="form-row">
                <!-- Тип контейнера -->
                <div class="form-group">
                    <label>Тип контейнера</label>
                    <div class="options-grid" id="containerOptionsGrid">
                        <!-- Карточка 20ft -->
                        <div class="option-card" data-value="20ft">
                            <div class="option-indicator"></div>
                            <div class="option-icon-small">
                                <img
                                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjEyMTIxIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHJlY3QgeD0iNCIgeT0iNCIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiByeD0iMiIvPjxsaW5lIHgxPSI4IiB5MT0iNCIgeDI9IjgiIHkyPSIyMCIgb3BhY2l0eT0iMC41Ii8+PHBhdGggZD0iTTE2IDR2MTZNMmE0IDAgMCAxIDQgNGgtMiIvPjwvc3ZnPg=="
                                    alt="20ft">
                            </div>
                            <span class="option-label">20ft</span>
                        </div>

                        <!-- Карточка 40ft -->
                        <div class="option-card" data-value="40ft">
                            <div class="option-indicator"></div>
                            <div class="option-icon-small">
                                <img
                                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjEyMTIxIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHJlY3QgeD0iMiIgeT0iNCIgd2lkdGg9IjIwIiBoZWlnaHQ9IjE2IiByeD0iMiIvPjxsaW5lIHgxPSIxMiIgeTE9IjQiIHgyPSIxMiIgeTI9IjIwIi8+PHBhdGggZD0iTTcgNHYxNk0xNyA0djE2IiBvcGFjaXR5PSIwLjUiLz48L3N2Zz4="
                                    alt="40ft">
                            </div>
                            <span class="option-label">40ft</span>
                        </div>
                    </div>
                    <!-- Скрытый инпут для хранения выбранного значения -->
                    <input type="hidden" id="containerType" value="20ft">
                </div>

                <!-- Тип транспорта -->
                <div class="form-group">
                    <label>Тип транспорта</label>
                    <div class="options-grid" id="transportOptionsGrid">
                        <!-- Авто -->
                        <div class="option-card" data-value="авто">
                            <div class="option-indicator"></div>
                            <div class="option-icon-small">
                                <img
                                    src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMjEyMTIxIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHJlY3QgeD0iMSIgeT0iMyIgd2lkdGg9IjE1IiBoZWlnaHQ9IjEzIiByeD0iMiIvPjxwb2x5Z29uIHBvaW50cz0iMTYgOCAyMCA4IDIzIDExIDIzIDE2IDE2IDE2IDE2IDgiLz48Y2lyY2xlIGN4PSI1LjUiIGN5PSIxOC41IiByPSIyLjUiLz48Y2lyY2xlIGN4PSIxOC41IiBjeT0iMTguNSIgcj0iMi41Ii8+PC9zdmc+"
                                    alt="Авто">
                            </div>
                            <span class="option-label">Авто</span>
                        </div>

                        <!-- Ж/Д -->
                        <div class="option-card" data-value="ж/д">
                            <div class="option-indicator"></div>
                            <div class="option-icon-small">
                                <?xml version="1.0" encoding="UTF-8"?>
                                <svg id="svg" stroke="#000000" width="26px" height="26px" viewBox="144 144 512 512" xmlns="http://www.w3.org/2000/svg">
                                    <g id="IconSvg_bgCarrier" stroke-width="0"></g>
                                    <g id="IconSvg_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" stroke="#CCCCCC"></g>
                                    <g id="IconSvg_iconCarrier">
                                        <g xmlns="http://www.w3.org/2000/svg">
                                            <path d="m636.64 472.14c-3.1289 0-5.7266 2.5938-5.7266 5.7266v4.8086l-9.5391-0.003906v-15.418c0-3.1289-2.5938-5.7266-5.7266-5.7266h-10.23c3.2812-4.582 5.3438-10.078 5.3438-16.105v-210.38c0-15.191-12.367-27.559-27.559-27.559h-366.4c-15.191 0-27.559 12.367-27.559 27.559v210.38c0 6.0312 1.9844 11.602 5.3438 16.105h-10.23c-3.1289 0-5.7227 2.5977-5.7227 5.7266v15.418h-9.543v-4.8086c0-3.1289-2.5938-5.7266-5.7266-5.7266-3.1289 0-5.7266 2.5938-5.7266 5.7266v20.992c0 3.1289 2.5938 5.7266 5.7266 5.7266 3.1289 0 5.7266-2.5938 5.7266-5.7266v-4.8086h9.543v15.418c0 3.1289 2.5938 5.7266 5.7266 5.7266h28.621c-9.0078 8.0898-14.734 19.848-14.734 32.898 0 24.504 19.922 44.426 44.426 44.426 16.566 0 30.992-9.1602 38.625-22.672 7.6328 13.512 22.062 22.672 38.703 22.672 24.426 0 44.352-19.922 44.352-44.426 0-13.055-5.7266-24.734-14.734-32.898h100.84c-9.0078 8.0898-14.734 19.848-14.734 32.898 0 24.504 19.922 44.426 44.426 44.426 16.566 0 30.992-9.1602 38.625-22.672 7.6328 13.512 22.062 22.672 38.703 22.672 24.426 0 44.352-19.922 44.352-44.426 0-13.055-5.7266-24.734-14.734-32.898h28.625c3.1289 0 5.7266-2.5938 5.7266-5.7266v-15.418h9.543v4.8086c0 3.1289 2.5938 5.7266 5.7266 5.7266 3.1289 0 5.7266-2.5938 5.7266-5.7266v-20.992c-0.074219-3.1289-2.6719-5.7227-5.8008-5.7227zm-435.95-237.1c0-8.8555 7.25-16.105 16.105-16.105h366.41c8.8555 0 16.105 7.25 16.105 16.105v210.38c0 8.8555-7.25 16.105-16.105 16.105h-366.4c-8.8555 0-16.105-7.25-16.105-16.105zm41.984 346.03c-18.168 0-32.977-14.809-32.977-32.977 0-18.168 14.809-32.898 32.977-32.898 16.184 0 29.617 11.754 32.289 27.176h-21.832c-2.0625-3.7422-5.9531-6.2578-10.457-6.2578-6.6406 0-11.984 5.3438-11.984 11.984s5.3438 11.984 11.984 11.984c4.5039 0 8.3984-2.5195 10.457-6.2578h21.832c-2.7461 15.488-16.105 27.246-32.289 27.246zm29.617-65.801h17.938c-3.5859 3.207-6.6406 6.9453-9.0078 11.145-2.2891-4.1992-5.3398-7.9414-8.9297-11.145zm80.535 32.824c0 18.168-14.734 32.977-32.898 32.977-16.184 0-29.617-11.754-32.367-27.176h21.832c2.0625 3.7422 5.9531 6.2578 10.457 6.2578 6.6406 0 11.984-5.3438 11.984-11.984 0-6.6406-5.3438-11.984-11.984-11.984-4.5039 0-8.4727 2.5195-10.457 6.2578h-21.832c2.75-15.418 16.184-27.176 32.367-27.176 18.164 0.003906 32.898 14.734 32.898 32.828zm127.32 32.977c-18.168 0-32.977-14.809-32.977-32.977 0-18.168 14.809-32.898 32.977-32.898 16.184 0 29.617 11.754 32.289 27.176h-21.832c-2.0625-3.7422-5.9531-6.2578-10.457-6.2578-6.6406 0-11.984 5.3438-11.984 11.984s5.3438 11.984 11.984 11.984c4.5039 0 8.3984-2.5195 10.457-6.2578h21.832c-2.7461 15.488-16.18 27.246-32.289 27.246zm29.621-65.801h17.938c-3.5859 3.207-6.6406 6.9453-9.0078 11.145-2.3672-4.1992-5.418-7.9414-8.9297-11.145zm80.457 32.824c0 18.168-14.734 32.977-32.898 32.977-16.184 0-29.617-11.754-32.367-27.176h21.832c2.0625 3.7422 5.9531 6.2578 10.457 6.2578 6.6406 0 11.984-5.3438 11.984-11.984 0-6.6406-5.3438-11.984-11.984-11.984-4.5039 0-8.4727 2.5195-10.457 6.2578h-21.832c2.75-15.418 16.184-27.176 32.367-27.176 18.164 0.003906 32.898 14.734 32.898 32.828zm19.691-44.277h-419.84v-30.84h419.84z"/>
                                            <path d="m252.45 439.84c11.832 0 21.527-9.6172 21.527-21.527l-0.003906-156.25c0-11.832-9.6172-21.527-21.527-21.527s-21.527 9.6172-21.527 21.527v156.26c0.003907 11.906 9.6211 21.523 21.531 21.523zm-10.078-177.78c0-5.5742 4.5039-10.078 10.078-10.078 5.5742 0 10.078 4.5039 10.078 10.078v156.26c0 5.5742-4.5039 10.078-10.078 10.078-5.5742 0-10.078-4.5039-10.078-10.078z"/>
                                            <path d="m326.18 439.84c11.832 0 21.527-9.6172 21.527-21.527v-156.25c0-11.832-9.6172-21.527-21.527-21.527s-21.527 9.6172-21.527 21.527v156.26c0.078125 11.906 9.6953 21.523 21.527 21.523zm-10-177.78c0-5.5742 4.5039-10.078 10.078-10.078s10.078 4.5039 10.078 10.078v156.26c0 5.5742-4.5039 10.078-10.078 10.078s-10.078-4.5039-10.078-10.078z"/>
                                            <path d="m400 439.84c11.832 0 21.527-9.6172 21.527-21.527l-0.003906-156.25c0-11.832-9.6172-21.527-21.527-21.527s-21.527 9.6172-21.527 21.527v156.26c0.003906 11.906 9.6992 21.523 21.531 21.523zm-10.078-177.78c0-5.5742 4.5039-10.078 10.078-10.078s10.078 4.5039 10.078 10.078v156.26c0 5.5742-4.5039 10.078-10.078 10.078s-10.078-4.5039-10.078-10.078z"/>
                                            <path d="m473.81 439.84c11.832 0 21.527-9.6172 21.527-21.527v-156.25c0-11.832-9.6172-21.527-21.527-21.527s-21.527 9.6172-21.527 21.527v156.26c0.003906 11.906 9.6211 21.523 21.527 21.523zm-10.074-177.78c0-5.5742 4.5039-10.078 10.078-10.078 5.5742 0 10.078 4.5039 10.078 10.078v156.26c0 5.5742-4.5039 10.078-10.078 10.078-5.5742 0-10.078-4.5039-10.078-10.078z"/>
                                            <path d="m547.55 439.84c11.832 0 21.527-9.6172 21.527-21.527l-0.003906-156.25c0-11.832-9.6172-21.527-21.527-21.527-11.91 0-21.527 9.6172-21.527 21.527v156.26c0.082031 11.906 9.6992 21.523 21.531 21.523zm-10-177.78c0-5.5742 4.5039-10.078 10.078-10.078 5.5742 0 10.078 4.5039 10.078 10.078v156.26c0 5.5742-4.5039 10.078-10.078 10.078-5.5742 0-10.078-4.5039-10.078-10.078z"/>
                                        </g>

                                    </g>
                                </svg>
                            </div>
                            <span class="option-label">Ж/Д</span>
                        </div>

                        <!-- Морской -->
                        <div class="option-card" data-value="морской">
                            <div class="option-indicator"></div>
                            <div class="option-icon-small">
                                <img
                                    src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMzYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMjAuNDIgMTIuMzY5OUMyMS4yOSAxMi43MTk5IDIxLjgzIDEzLjc0OTkgMjEuNjMgMTQuNjU5OUwyMS4yMiAxNi41MTk5QzIwLjUxIDE5LjcxOTkgMTggMjEuOTk5OSAxNC4zOCAyMS45OTk5SDkuNjE5OThDNS45OTk5OCAyMS45OTk5IDMuNDg5OTkgMTkuNzE5OSAyLjc3OTk5IDE2LjUxOTlMMi4zNjk5OCAxNC42NTk5QzIuMTY5OTggMTMuNzQ5OSAyLjcwOTk3IDEyLjcxOTkgMy41Nzk5NyAxMi4zNjk5TDQuOTk5OTkgMTEuNzk5OUwxMC41MSA5LjU4OTkzQzExLjQ3IDkuMjA5OTMgMTIuNTMgOS4yMDk5MyAxMy40OSA5LjU4OTkzTDE5IDExLjc5OTlMMjAuNDIgMTIuMzY5OVoiIHN0cm9rZT0iIzIxMjEyMSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTIgMjJWMTAiIHN0cm9rZT0iIzIxMjEyMSIgc3Ryb2tlLXdpZHRoPSIyIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz48cGF0aCBkPSJNMTkgOFYxMS44TDEzLjQ5IDkuNTlDMTIuNTMgOS4yMSAxMS40NyA5LjIxIDEwLjUxIDkuNTlMNSAxMS44VjhDNSA2LjM1IDYuMzUgNSA4IDVIMTZDMTcuNjUgNSAxOSA2LjM1IDE5IDhaIiBzdHJva2U9IiMyMTIxMjEiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PHBhdGggZD0iTTE0LjUgNUg5LjVWM0M5LjUgMi40NSA5Ljk1IDIgMTAuNSAySDEzLjVDMTQuMDUgMiAxNC41IDIuNDUgMTQuNSAzVjVaIiBzdHJva2U9IiMyMTIxMjEiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+PC9zdmc+"
                                    alt="Море">
                            </div>
                            <span class="option-label">Море</span>
                        </div>
                    </div>
                    <!-- Скрытый инпут -->
                    <input type="hidden" id="transportType" value="авто">
                </div>

            </div>


            <div class="form-row">
                <!-- Поле Ставка с выбором валюты -->
                <div class="form-group">
                    <label for="rate">Ставка</label>
                    <div class="rate-input-wrapper">
                        <input type="number" id="rate" placeholder="0.00">

                        <div class="currency-toggles">
                            <button type="button" class="currency-btn" data-value="RUB">₽</button>
                            <button type="button" class="currency-btn" data-value="USD">$</button>
                        </div>

                        <!-- Скрытое поле для передачи значения в JS -->
                        <input type="hidden" id="currency" value="">
                    </div>
                </div>

                <!-- Поле Дата расчёта -->
                <div class="form-group">
                    <label for="calculationDate">Дата расчёта</label>
                    <input type="date" id="calculationDate">
                </div>
            </div>

            <div class="form-group">
                <label for="processingStatus">Корректность обработки</label>
                <select id="processingStatus">
                    <option value="correct">Корректно</option>
                    <option value="incorrect">Некорректно</option>
                    <option value="pending">В обработке</option>
                </select>
            </div>

            <div class="form-group">
                <label for="comments">Комментарии</label>
                <textarea id="comments" placeholder="Введите комментарии" rows="3"></textarea>
            </div>

            <div class="modal-footer">
                <button class="cancel-btn" id="cancelModalBtn">Отмена</button>
                <button class="save-btn" id="saveRecordBtn">Сохранить письмо</button>
            </div>
        </div>
    </div>

    <footer class="auth-only">
        <div class="copyright">&copy; АТК. Все права защищены.</div>
    </footer>
</body>
</html>